- Plusieurs techniques de scans possibles
- Détection de versions de services / OS
- Script de scan et d’énumération automatique
- Usurpation d’identité et d’évasion de surveillance
![[FORMATION EXPERT SECURITE DIGITALE (ESD)/RESSOURCES/Images/Pasted image 20221123093239.png]]
![[FORMATION EXPERT SECURITE DIGITALE (ESD)/RESSOURCES/Images/Pasted image 20221123093216.png]]
![[FORMATION EXPERT SECURITE DIGITALE (ESD)/RESSOURCES/Images/Pasted image 20221123093304.png]]
La différence entre les scans précédents se situe principalement sur les
comportements des pare-feu :
- Les TCP Open scan vont vérifier si les ports sont ouverts ou fermés.
- Tandis que Le TCP ACK scan a pour but de vérifier si un filtrage est actif.
- Le XMAS quant à lui tentera de déjouer certains pare-feu avec des flags inhabituels.
- Ces différences se joueront sur le comportement de la réponse de la cible pour savoir s’il y a présence d’un filtrage.

Banner Grabbing: 
```sh
nmap $IP -sV # Serice Version
nmap $IP -O # banner identification
nmap $IP -Pn # Sans Ping
```

Extraction des informations des bannières pouvant contenir :-
- Des versions de systèmes d’exploitation
- Des versions de services

TIPS -> Export vers XML puis versi HTML 

```sh
nmap $IP -oX scan.xml && xsltproc scan.xml -o scan.html
```

## Énumération des protocoles

L’analyse protocolaire permet d’identifier les ports et services présents sur un réseau :
- Informations relatives à SMB / RPC
- Communauté SNMP par défaut
- Versions des services web
- Versions des SGBD
- Présence d’accès distants (SSH, RDP, VNC, ...)
- Etc.


Nmap et les scripts
- Nmap embarque des scripts (situés dans /usr/share/nmap/scripts) pouvant être utilisés
durant la phase de scan.
- Ils permettent d’obtenir davantage d’informations sur les services que le scan détectera.
- Les scripts peuvent avoir des arguments via l’option --scripts-args

```sh
nmap --script mysql* -p 3306 <IP> #Exécutera tous les scripts relatifs à MySQL
nmap <IP> -sC -T4 # Exécutera tous les scripts en mode agressif sur les services énumérés
nmap <IP> --script discovery # Exécutera les script spécifique de reconnaissance réseau
nmap <IP> --script ftp-brute --script-args timeout=5,passdb=passlist.txt,userdb=users.txt
#Effectue des tentatives de mots de passe via une liste d’users et mots de passes avec un timeout de 5 secondes

## Scan discret
# Scan fragmenté + Stealth scan
nmap –f –sS <IP>
# Scan discret (template)
nmap -T0 <IP>
# Scan avec spoof d’identité
nmap -S <TARGET> <SPOOF> -e eth0
#Scan avec spoof d'adresse mac <XX:XX:XX:XX:XX:XX>
nmap 192.168.239.129 --spoof-mac <MAC>
#Idle scan depuis l'hôte 192.168.1.19
nmap -sI <IDLE> <TARGET>

## Énumération agressive
# Énumération agressive (attention verbeux)
nmap -A -T5 -sC <IP>
#Scan version + système d’exploitation
nmap -sV -version-all -O -osscan-guess <IP>

## Énumération ciblée
#Énumération UDP ciblé sur DNS & SNMP
nmap -sU –p 53,161,162 --script dns*,snmp* <IP>
#Scan des versions de services uniquement
nmap –sV <IP>
#enumeration RPC via un script ciblé
nmap -p 135-445 -script msrpc-enum.nse <IP>

```